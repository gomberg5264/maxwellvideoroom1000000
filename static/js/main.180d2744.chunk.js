(this.webpackJsonpvideo=this.webpackJsonpvideo||[]).push([[0],{1235:function(e,t,n){},1295:function(e,t,n){},1297:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(8),r=n.n(i),c=n(33),l=n(34),s=n(35),d=n(37),u=n(143),m=n(83),h=n.n(m),g=n(117),f=n(56),v=n(118),p=n.n(v),w=n(119),y=n.n(w),b=n(1319),S=n(1320),E=n(1321),C=n(1318),k=n(132),x=n.n(k),O=n(133),j=n.n(O),M=n(135),A=n.n(M),D=n(136),T=n.n(D),U=n(137),V=n.n(U),N=n(138),F=n.n(N),W=n(134),R=n.n(W),L=n(139),P=n.n(L),J=n(1322),B=(n(1233),n(1323)),H=n(39),I=(n(1234),n(1235),{}),q={iceServers:[{urls:"stun:stun.l.google.com:19302"}]},z=null,G=null,Y=0,$=function(e){Object(d.a)(n,e);var t=Object(s.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).getPermissions=Object(g.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:!0}).then((function(e){a.videoAvailable=!0,a.video=!0})).catch((function(e){a.videoAvailable=!1}));case 2:return e.next=4,navigator.mediaDevices.getUserMedia({audio:!0}).then((function(e){a.audioAvailable=!0,a.audio=!0})).catch((function(e){a.audioAvailable=!1}));case 4:navigator.mediaDevices.getDisplayMedia?a.setState({screenAvailable:!0}):a.setState({screenAvailable:!1}),(a.videoAvailable||a.audioAvailable)&&navigator.mediaDevices.getUserMedia({video:a.videoAvailable,audio:a.audioAvailable}).then((function(e){window.localStream=e,a.localVideoref.current.srcObject=e})).then((function(e){})).catch((function(e){return console.log(e)}));case 6:case"end":return e.stop()}}),e)}))),a.getMedia=function(){a.setState({video:a.video,audio:a.audio,screen:a.screen},(function(){a.getUserMedia(),a.connectToSocketServer()}))},a.getUserMedia=function(){if(a.state.video&&a.videoAvailable||a.state.audio&&a.audioAvailable)navigator.mediaDevices.getUserMedia({video:a.state.video,audio:a.state.audio}).then(a.getUserMediaSuccess).then((function(e){})).catch((function(e){return console.log(e)}));else try{a.localVideoref.current.srcObject.getTracks().forEach((function(e){return e.stop()}))}catch(e){}},a.getUserMediaSuccess=function(e){try{window.localStream.getTracks().forEach((function(e){return e.stop()}))}catch(o){console.log(o)}window.localStream=e,a.localVideoref.current.srcObject=e;var t=function(e){if(e===G)return"continue";I[e].addStream(window.localStream),I[e].createOffer().then((function(t){I[e].setLocalDescription(t).then((function(){z.emit("signal",e,JSON.stringify({sdp:I[e].localDescription}))})).catch((function(e){return console.log(e)}))}))};for(var n in I)t(n);e.getVideoTracks()[0].onended=function(){a.setState({video:!1,audio:!1},(function(){try{a.localVideoref.current.srcObject.getTracks().forEach((function(e){return e.stop()}))}catch(o){console.log(o)}var e=function(){var e=new AudioContext,t=e.createOscillator(),n=t.connect(e.createMediaStreamDestination());return t.start(),e.resume(),Object.assign(n.stream.getAudioTracks()[0],{enabled:!1})},t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.width,n=void 0===t?640:t,a=e.height,o=void 0===a?480:a,i=Object.assign(document.createElement("canvas"),{width:n,height:o});i.getContext("2d").fillRect(0,0,n,o);var r=i.captureStream();return Object.assign(r.getVideoTracks()[0],{enabled:!1})};window.localStream=function(){return new MediaStream([t.apply(void 0,arguments),e()])}(),a.localVideoref.current.srcObject=window.localStream;var n=function(e){I[e].addStream(window.localStream),I[e].createOffer().then((function(t){I[e].setLocalDescription(t).then((function(){z.emit("signal",e,JSON.stringify({sdp:I[e].localDescription}))})).catch((function(e){return console.log(e)}))}))};for(var i in I)n(i)}))}},a.getDislayMedia=function(){a.state.screen&&navigator.mediaDevices.getDisplayMedia&&navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0}).then(a.getDislayMediaSuccess).then((function(e){})).catch((function(e){return console.log(e)}))},a.getDislayMediaSuccess=function(e){try{window.localStream.getTracks().forEach((function(e){return e.stop()}))}catch(o){console.log(o)}window.localStream=e,a.localVideoref.current.srcObject=e;var t=function(e){if(e===G)return"continue";I[e].addStream(window.localStream),I[e].createOffer().then((function(t){I[e].setLocalDescription(t).then((function(){z.emit("signal",e,JSON.stringify({sdp:I[e].localDescription}))})).catch((function(e){return console.log(e)}))}))};for(var n in I)t(n);e.getVideoTracks()[0].onended=function(){a.setState({screen:!1},(function(){try{a.localVideoref.current.srcObject.getTracks().forEach((function(e){return e.stop()}))}catch(o){console.log(o)}var e=function(){var e=new AudioContext,t=e.createOscillator(),n=t.connect(e.createMediaStreamDestination());return t.start(),e.resume(),Object.assign(n.stream.getAudioTracks()[0],{enabled:!1})},t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.width,n=void 0===t?640:t,a=e.height,o=void 0===a?480:a,i=Object.assign(document.createElement("canvas"),{width:n,height:o});i.getContext("2d").fillRect(0,0,n,o);var r=i.captureStream();return Object.assign(r.getVideoTracks()[0],{enabled:!1})};window.localStream=function(){return new MediaStream([t.apply(void 0,arguments),e()])}(),a.localVideoref.current.srcObject=window.localStream,a.getUserMedia()}))}},a.gotMessageFromServer=function(e,t){var n=JSON.parse(t);e!==G&&(n.sdp&&I[e].setRemoteDescription(new RTCSessionDescription(n.sdp)).then((function(){"offer"===n.sdp.type&&I[e].createAnswer().then((function(t){I[e].setLocalDescription(t).then((function(){z.emit("signal",e,JSON.stringify({sdp:I[e].localDescription}))})).catch((function(e){return console.log(e)}))})).catch((function(e){return console.log(e)}))})).catch((function(e){return console.log(e)})),n.ice&&I[e].addIceCandidate(new RTCIceCandidate(n.ice)).catch((function(e){return console.log(e)})))},a.connectToSocketServer=function(){(z=p.a.connect("https://video.sebastienbiollo.com",{secure:!0})).on("signal",a.gotMessageFromServer),z.on("connect",(function(){console.log("connected"),z.emit("join-call",window.location.href),G=z.id,z.on("chat-message",a.addMessage),z.on("user-left",(function(e){var t=document.querySelector('[data-socket="'.concat(e,'"]'));if(null!==t){Y--,t.parentNode.removeChild(t);var n=document.getElementById("main"),a=n.querySelectorAll("video"),o="30%";30*n.offsetWidth/100<300&&(o="300px");var i=String(100/Y)+"%",r="";1===Y||2===Y?(r="45%",i="100%"):3===Y||4===Y?(r="35%",i="50%"):r=String(100/Y)+"%";for(var c=0;c<a.length;++c)a[c].style.minWidth=o,a[c].style.minHeight="40%",a[c].style.setProperty("width",r),a[c].style.setProperty("height",i)}})),z.on("user-joined",(function(e,t){console.log("joined"),t.forEach((function(e){if(I[e]=void 0,void 0===I[e])if(console.log("new entry"),I[e]=new RTCPeerConnection(q),I[e].onicecandidate=function(t){null!=t.candidate&&z.emit("signal",e,JSON.stringify({ice:t.candidate}))},I[e].onaddstream=function(n){var a=document.querySelector('[data-socket="'.concat(e,'"]'));if(null!==a)a.srcObject=n.stream;else{Y=t.length;var o=document.getElementById("main"),i=o.querySelectorAll("video"),r="30%";30*o.offsetWidth/100<300&&(r="300px");var c=String(100/Y)+"%",l="";1===Y||2===Y?(l="45%",c="100%"):3===Y||4===Y?(l="35%",c="50%"):l=String(100/Y)+"%";for(var s=0;s<i.length;++s)i[s].style.minWidth=r,i[s].style.minHeight="40%",i[s].style.setProperty("width",l),i[s].style.setProperty("height",c);var d=document.createElement("video");d.style.minWidth=r,d.style.minHeight="40%",d.style.maxHeight="100%",d.style.setProperty("width",l),d.style.setProperty("height",c),d.style.margin="10px",d.style.borderStyle="solid",d.style.borderColor="#bdbdbd",d.style.objectFit="fill",d.setAttribute("data-socket",e),d.srcObject=n.stream,d.autoplay=!0,d.playsinline=!0,o.appendChild(d)}},void 0!==window.localStream&&null!==window.localStream)I[e].addStream(window.localStream);else{var n=function(){var e=new AudioContext,t=e.createOscillator(),n=t.connect(e.createMediaStreamDestination());return t.start(),e.resume(),Object.assign(n.stream.getAudioTracks()[0],{enabled:!1})},a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.width,n=void 0===t?640:t,a=e.height,o=void 0===a?480:a,i=Object.assign(document.createElement("canvas"),{width:n,height:o});i.getContext("2d").fillRect(0,0,n,o);var r=i.captureStream();return Object.assign(r.getVideoTracks()[0],{enabled:!1})};window.localStream=function(){return new MediaStream([a.apply(void 0,arguments),n()])}(),I[e].addStream(window.localStream)}})),e!==G&&I[e].createOffer().then((function(t){I[e].setLocalDescription(t).then((function(){z.emit("signal",e,JSON.stringify({sdp:I[e].localDescription}))})).catch((function(e){return console.log(e)}))}))}))}))},a.handleVideo=function(){a.setState({video:!a.state.video},(function(){a.getUserMedia()}))},a.handleAudio=function(){a.setState({audio:!a.state.audio},(function(){a.getUserMedia()}))},a.handleScreen=function(){a.setState({screen:!a.state.screen},(function(){a.getDislayMedia()}))},a.handleEndCall=function(){try{a.localVideoref.current.srcObject.getTracks().forEach((function(e){return e.stop()}))}catch(e){}window.location.href="/"},a.openChat=function(){a.setState({showModal:!0,newmessages:0})},a.closeChat=function(){a.setState({showModal:!1})},a.handleMessage=function(e){a.setState({message:e.target.value})},a.addMessage=function(e,t){a.setState((function(n){return{messages:[].concat(Object(u.a)(n.messages),[{sender:t,data:e}])}})),t!==G&&a.setState({newmessages:a.state.newmessages+1})},a.sendMessage=function(){z.emit("chat-message",a.state.message),a.setState({message:""})},a.copyUrl=function(e){var t=window.location.href;if(navigator.clipboard)navigator.clipboard.writeText(t).then((function(){J.a.success("Link copied to clipboard!")}),(function(e){J.a.error("Failed to copy")}));else{var n=document.createElement("textarea");n.value=t,document.body.appendChild(n),n.focus(),n.select();try{document.execCommand("copy"),J.a.success("Link copied to clipboard!")}catch(a){J.a.error("Failed to copy")}document.body.removeChild(n)}},a.handleUsername=function(e){a.setState({username:e.target.value})},a.connect=function(){a.setState({askForUsername:!1},(function(){a.getMedia()}))},a.isChromeOrFirefox=function(){var e=(navigator&&navigator.userAgent||"").toLowerCase(),t=(navigator&&navigator.vendor||"").toLowerCase(),n=/google inc/.test(t)?e.match(/(?:chrome|crios)\/(\d+)/):null,a=e.match(/(?:firefox|fxios)\/(\d+)/);return null!==n||null!==a},a.localVideoref=o.a.createRef(),a.videoAvailable=!1,a.audioAvailable=!1,a.video=!1,a.audio=!1,a.screen=!1,a.state={video:!1,audio:!1,screen:!1,showModal:!1,screenAvailable:!1,messages:[],message:"",newmessages:0,askForUsername:!0,username:y.a.internet.userName()},I={},a.addMessage=a.addMessage.bind(Object(f.a)(a)),a.getPermissions(),a}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return!1===this.isChromeOrFirefox()?o.a.createElement("div",{style:{background:"white",width:"30%",height:"auto",padding:"20px",minWidth:"400px",textAlign:"center",margin:"auto",marginTop:"50px",justifyContent:"center"}},o.a.createElement("h1",null,"Use Chrome or Firefox")):o.a.createElement("div",null,!0===this.state.askForUsername?o.a.createElement("div",null,o.a.createElement("div",{style:{background:"white",width:"30%",height:"auto",padding:"20px",minWidth:"400px",textAlign:"center",margin:"auto",marginTop:"50px",justifyContent:"center"}},o.a.createElement("p",{style:{margin:0,fontWeight:"bold",paddingRight:"50px"}},"Set your username"),o.a.createElement(E.a,{placeholder:"Username",value:this.state.username,onChange:function(t){return e.handleUsername(t)}}),o.a.createElement(C.a,{variant:"contained",color:"primary",onClick:this.connect,style:{margin:"20px"}},"Connect")),o.a.createElement("div",{style:{justifyContent:"center",textAlign:"center",paddingTop:"40px"}},o.a.createElement("video",{id:"my-video",ref:this.localVideoref,autoPlay:!0,muted:!0,style:{borderStyle:"solid",borderColor:"#bdbdbd",objectFit:"fill",width:"60%",height:"30%"}}))):o.a.createElement("div",null,o.a.createElement("div",{className:"btn-down",style:{backgroundColor:"whitesmoke",color:"whitesmoke",textAlign:"center"}},o.a.createElement(b.a,{style:{color:"#424242"},onClick:this.handleVideo},!0===this.state.video?o.a.createElement(x.a,null):o.a.createElement(j.a,null)),o.a.createElement(b.a,{style:{color:"#f44336"},onClick:this.handleEndCall},o.a.createElement(R.a,null)),o.a.createElement(b.a,{style:{color:"#424242"},onClick:this.handleAudio},!0===this.state.audio?o.a.createElement(A.a,null):o.a.createElement(T.a,null)),!0===this.state.screenAvailable?o.a.createElement(b.a,{style:{color:"#424242"},onClick:this.handleScreen},!0===this.state.screen?o.a.createElement(V.a,null):o.a.createElement(F.a,null)):null,o.a.createElement(S.a,{badgeContent:this.state.newmessages,max:999,color:"secondary",onClick:this.openChat},o.a.createElement(b.a,{style:{color:"#424242"},onClick:this.openChat},o.a.createElement(P.a,null)))),o.a.createElement(H.a,{show:this.state.showModal,onHide:this.closeChat,style:{zIndex:"999999"}},o.a.createElement(H.a.Header,{closeButton:!0},o.a.createElement(H.a.Title,null,"Chat Room")),o.a.createElement(H.a.Body,{style:{overflow:"auto",overflowY:"auto",height:"400px"}},this.state.messages.length>0?this.state.messages.map((function(e,t){return o.a.createElement("div",{key:e.sender+e.data+t},o.a.createElement("b",null,e.sender),o.a.createElement("p",{style:{wordBreak:"break-all"}},e.data))})):o.a.createElement("p",null,"No message yet")),o.a.createElement(H.a.Footer,{className:"div-send-msg"},o.a.createElement(E.a,{placeholder:"Message",value:this.state.message,onChange:function(t){return e.handleMessage(t)}}),o.a.createElement(C.a,{variant:"contained",color:"primary",onClick:this.sendMessage},"Send"))),o.a.createElement("div",{className:"container"},o.a.createElement("div",{style:{paddingTop:"20px"}},o.a.createElement(E.a,{value:window.location.href,disable:"true"}),o.a.createElement(C.a,{style:{backgroundColor:"#3f51b5",color:"whitesmoke",marginLeft:"20px",marginTop:"10px",width:"120px",fontSize:"10px"},onClick:this.copyUrl},"Copy invite link")),o.a.createElement(B.a,{id:"main",className:"flex-container",style:{margin:0,padding:0}},o.a.createElement("video",{id:"my-video",ref:this.localVideoref,autoPlay:!0,muted:!0,style:{borderStyle:"solid",borderColor:"#bdbdbd",margin:"10px",objectFit:"fill",width:"100%",height:"100%"}})))))}}]),n}(a.Component),K=(n(1295),function(e){Object(d.a)(n,e);var t=Object(s.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).handleChange=function(e){a.setState({url:e.target.value})},a.join=function(){if(""!==a.state.url)(a.state.url.includes(window.location.href)||a.state.url.includes(window.location.href.substring(8,window.location.href.length)))&&(window.location.href=a.state.url),window.location.href="/".concat(a.state.url);else{var e=Math.random().toString(36).substring(2,7);window.location.href="/".concat(e)}},a.state={url:""},a}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"container2"},o.a.createElement("div",null,o.a.createElement("h1",{style:{fontSize:"45px"}},"Video Meeting"),o.a.createElement("p",{style:{fontWeight:"200"}},"Video conference website that lets you stay in touch with all your friends.")),o.a.createElement("div",{style:{background:"white",width:"30%",height:"auto",padding:"20px",minWidth:"400px",textAlign:"center",margin:"auto",marginTop:"100px"}},o.a.createElement("p",{style:{margin:0,fontWeight:"bold",paddingRight:"50px"}},"Start or join a meeting"),o.a.createElement(E.a,{placeholder:"URL",onChange:function(t){return e.handleChange(t)}}),o.a.createElement(C.a,{variant:"contained",color:"primary",onClick:this.join,style:{margin:"20px"}},"Go")))}}]),n}(a.Component)),Q=n(141),X=n(22),Z=function(e){Object(d.a)(n,e);var t=Object(s.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(Q.a,null,o.a.createElement(X.c,null,o.a.createElement(X.a,{path:"/",exact:!0,component:K}),o.a.createElement(X.a,{path:"/:url",component:$}))))}}]),n}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(Z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},149:function(e,t,n){e.exports=n(1297)},184:function(e,t){}},[[149,1,2]]]);
//# sourceMappingURL=main.180d2744.chunk.js.map